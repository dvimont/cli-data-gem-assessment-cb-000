#!/usr/bin/env ruby

require_relative '../config/environment'

puts "*** BUILDING CATALOG OF AUDIOBOOKS! ***"
optional_parm = "&id=7926" # get explicit audiobook webpage for development/testing
# CatalogBuilder.build(10, :save_http_responses) # 10000, optional_parm)
CatalogBuilder.build(525, :local_uri_calls)
#Audiobook.list_all

puts "AUDIOBOOKS (#{Audiobook.all.size.to_s})"
puts "AUTHORS (" + Author.all.size.to_s + "):"
# Author.all_by_name.values.each{|author| puts " -- " + author.to_s}
=begin
Author.all_by_name.values.each{|author|
  puts author.id + " " + author.to_s
  puts "  -- " + author.audiobooks_by_title.size.to_s + " audiobooks by this author."
  author.audiobooks_by_title.values.each{|audiobook|
    puts "  -- " + audiobook.title + " online text URL: " + audiobook.url_text.to_s
    puts "     GUTENBERG SUBJECTS ARE AS FOLLOWS:"
    audiobook.gutenberg_subjects.each{|subject|
      puts "        >> " + subject
    }
  }
}
=end
puts "READERS (" + Reader.all_by_name.size.to_s + "):"
# Reader.all_by_name.values.each{|reader| puts " -- " + reader.to_s}

puts "LANGUAGES (" + Language.all.size.to_s + "):"
=begin
Language.all.each{|key, language|
  puts language.id.to_s
  puts language.audiobooks_by_title.size.to_s + " audiobooks in this language."

#=begin
  puts "== this language's audiobooks by title"
  language.audiobooks_by_title.values.each{|audiobook| puts "  " + audiobook.title}
  puts "==="
  puts "== this languages's audiobooks by date of release"
  language.audiobooks_by_date.values.each{|audiobook| puts "  " + audiobook.date_released +
        " " + audiobook.title}
#=end
}
=end

puts "GENRES from Librivox (#{GenreLibrivox.all.size.to_s})"
#GenreLibrivox.all.values.each {|genre| puts "  : #{genre.id} (#{genre.audiobooks.size.to_s})"}

puts "GENRES from Gutenberg (#{GenreGutenberg.all.size.to_s})"
GenreGutenberg.all.values.each {|genre| puts "  : #{genre.id} (#{genre.audiobooks.size.to_s})"}

puts "=====\nAudiobook count: " + Audiobook.all.size.to_s
# Audiobook.all.each{|audiobook| puts "url: " + audiobook.url_librivox}
